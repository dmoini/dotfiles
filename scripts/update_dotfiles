#!/bin/bash

source ~/.functions

DOTFILES_DIR="${HOME}/code/dotfiles"
VSCODE_DIR="${HOME}/Library/Application Support/Code/User"

GREEN='\033[0;32m'
CYAN='\033[0;36m'
NC='\033[0m'

updateEcho() {
    echo -e "${NC}Updating $1 files${NC}"
}

updateGit() {
    updateEcho "Git"
    cp "${HOME}/.gitconfig" "${DOTFILES_DIR}/git"
}

updateHomebrew() {
    updateEcho "Homebrew"
    # If Brewfile already exists, delete it and create new one
    if [ -f Brewfile ]; then rm Brewfile; fi
    
    brew bundle dump
    mv Brewfile "${DOTFILES_DIR}/homebrew"
}

updateNPM() {
    updateEcho "NPM"
    # To import these packages, run `cat npm-global-packages.txt | xargs npm i -g`
    npm-global-packages > "${DOTFILES_DIR}/npm/npm-global-packages.txt"
}

updateOhMyZsh() {
    updateEcho "Oh My Zsh"
    cp "${HOME}/.zshrc" "${DOTFILES_DIR}/oh-my-zsh/"
    cp -r "${HOME}/.oh-my-zsh/custom" "${DOTFILES_DIR}/oh-my-zsh"
}

updatePip() {
    updateEcho "Pip"
    syspip freeze > "${DOTFILES_DIR}/pip/pip-global-packages.txt"
}

updateScripts() {
    updateEcho "script"
    cp -r "${HOME}/code/scripts" "${DOTFILES_DIR}"
}

updateShell() {
    updateEcho "shell"
    cp "${HOME}/.aliases" "${HOME}/.exports" "${HOME}/.functions" "${DOTFILES_DIR}/shell"
    cp "${HOME}/.exports" "${DOTFILES_DIR}/shell"
    cp "${HOME}/.functions" "${DOTFILES_DIR}/shell"
}

updateVim() {
    updateEcho "Vim"
    cp "${HOME}/.vimrc" "${DOTFILES_DIR}/vim"
    rsync -a "${HOME}/.vim" "${DOTFILES_DIR}/vim" --exclude .DS_Store --exclude .netrwhist &>/dev/null
}

updateVSCode() {
    updateEcho "VS Code"
    cp "${VSCODE_DIR}/settings.json" "${DOTFILES_DIR}/vscode"
    cp "${VSCODE_DIR}/keybindings.json" "${DOTFILES_DIR}/vscode"
}

updateAll() {
    # updateGit
    # updateHomebrew
    # updateNPM
    # updateOhMyZsh
    # updatePip
    
    updateScripts
    # updateShell
    # updateVim
    # updateVSCode
}

updateAll
